CREATE SCHEMA pharmacyDB;
go

-- create tables
CREATE TABLE pharmacyDB.pharmacies (
	pharmacy_name VARCHAR(255) PRIMARY KEY,
	pharmacy_address VARCHAR (255) NOT NULL,
    pharmacy_city VARCHAR(255) NOT NULL,
    pharmacy_state VARCHAR(255) NOT NULL,
    pharmacy_zip INTEGER NOT NUll,
    num_of_prescriptions INTEGER NOT NULL,
    creation_date DATETIME DEFAULT GETDATE(),
    last_update DATETIME DEFAULT GETDATE(),  
);
GO

CREATE TRIGGER pharmacyDB.set_last_update ON pharmacyDB.pharmacies
AFTER UPDATE
AS
UPDATE pharmacyDB.pharmacies
SET last_update = GETDATE()
WHERE pharmacy_name IN (SELECT DISTINCT pharmacy_name FROM inserted);